var gdjs;(function(t){class n{constructor(e){this._obstaclesRBush=new rbush}static getManager(e){return e.pathfindingObstaclesManager||(e.pathfindingObstaclesManager=new t.PathfindingObstaclesManager(e)),e.pathfindingObstaclesManager}addObstacle(e){e.currentRBushAABB?e.currentRBushAABB.updateAABBFromOwner():e.currentRBushAABB=new t.BehaviorRBushAABB(e),this._obstaclesRBush.insert(e.currentRBushAABB)}removeObstacle(e){this._obstaclesRBush.remove(e.currentRBushAABB)}getAllObstaclesAround(e,s,a,r){const i=t.staticObject(n.prototype.getAllObstaclesAround);i.minX=e-a,i.minY=s-a,i.maxX=e+a,i.maxY=s+a;const h=this._obstaclesRBush.search(i);r.length=0,h.forEach(o=>r.push(o.behavior))}}t.PathfindingObstaclesManager=n;class g extends t.RuntimeBehavior{constructor(e,s,a){super(e,s,a);this._oldX=0;this._oldY=0;this._oldWidth=0;this._oldHeight=0;this._registeredInManager=!1;this.currentRBushAABB=null;this._impassable=s.impassable,this._cost=s.cost,this._manager=n.getManager(e)}applyBehaviorOverriding(e){return e.impassable!==void 0&&this.setImpassable(e.impassable),e.cost!==void 0&&this.setCost(e.cost),!0}onDestroy(){this._manager&&this._registeredInManager&&this._manager.removeObstacle(this)}doStepPreEvents(e){!this.activated()&&this._registeredInManager?(this._manager.removeObstacle(this),this._registeredInManager=!1):this.activated()&&!this._registeredInManager&&(this._manager.addObstacle(this),this._registeredInManager=!0),(this._oldX!==this.owner.getX()||this._oldY!==this.owner.getY()||this._oldWidth!==this.owner.getWidth()||this._oldHeight!==this.owner.getHeight())&&(this._registeredInManager&&(this._manager.removeObstacle(this),this._manager.addObstacle(this)),this._oldX=this.owner.getX(),this._oldY=this.owner.getY(),this._oldWidth=this.owner.getWidth(),this._oldHeight=this.owner.getHeight())}doStepPostEvents(e){}getAABB(){return this.owner.getAABB()}onActivate(){this._registeredInManager||(this._manager.addObstacle(this),this._registeredInManager=!0)}onDeActivate(){!this._registeredInManager||(this._manager.removeObstacle(this),this._registeredInManager=!1)}getCost(){return this._cost}setCost(e){this._cost=e}isImpassable(){return this._impassable}setImpassable(e){this._impassable=e}}t.PathfindingObstacleRuntimeBehavior=g,t.registerBehavior("PathfindingBehavior::PathfindingObstacleBehavior",t.PathfindingObstacleRuntimeBehavior)})(gdjs||(gdjs={}));
//# sourceMappingURL=pathfindingobstacleruntimebehavior.js.map
